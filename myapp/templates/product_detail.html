{% load static %}

<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{{ product.name }}</title>

    <!-- CSS -->
    <link rel="stylesheet" href="{% static 'styles/product_detail.css' %}">

    <!-- Google Font -->
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600&display=swap" rel="stylesheet">

    <!-- Slick Slider (‡πÉ‡∏ä‡πâ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡πÅ‡∏™‡∏î‡∏á‡∏£‡∏π‡∏õ‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤) -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/slick-carousel/1.8.1/slick.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/slick-carousel/1.8.1/slick-theme.min.css">
</head>
<body>

    <!-- Navbar -->
    <header>
        <nav class="navbar">
            <div class="logo">
                <a href="{% url 'home' %}"><img src="{% static 'media/logo.jpg' %}" alt="Shop Logo"></a>
            </div>
            <ul class="nav-links">
                <li><a href="{% url 'home' %}">üè† Home</a></li>
                <li><a href="{% url 'community_list' %}">üë• Community</a></li>
                <li><a href="{% url 'savelist' %}">üíæ Save</a></li>
                <li><a href="{% url 'profile' request.user.id  %}">üìÑ Profile</a></li>
                <li><a href="{% url 'product_list' %}" class="active">üõç Products</a></li>
            </ul>
        </nav>
    </header>

    <!-- Product Detail Section -->
    <div class="product-container">
        <div class="product-box">
            <!-- Product Image Slider -->
            <div class="product-slider">
                {% if product.image %}
                    <div><img src="{{ product.image.url }}" alt="{{ product.name }}"></div>
                {% endif %}
                {% for img in product.extra_images.all %}
                    <div><img src="{{ img.image.url }}" alt="Extra Image"></div>
                {% endfor %}
            </div>

            <!-- Product Details -->
            <div class="product-info">
                <h2>{{ product.name }}</h2>
                <p class="price">üí∞ ‡∏£‡∏≤‡∏Ñ‡∏≤: ‡∏ø{{ product.price }}</p>
                <p class="stock">üì¶ ‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏Ñ‡∏á‡πÄ‡∏´‡∏•‡∏∑‡∏≠: {{ product.stock }}</p>
                <p class="description">üìú ‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤: {{ product.description }}</p>
                <p class="category">üìå ‡∏´‡∏°‡∏ß‡∏î‡∏´‡∏°‡∏π‡πà: {{ product.get_category_display }}</p>
                <p class="seller">üè™ ‡∏£‡πâ‡∏≤‡∏ô‡∏Ñ‡πâ‡∏≤: <a href="{% url 'store_detail' product.seller.id %}"><strong>{{ product.seller.store_name }}</strong></a></p>

                <!-- üõí ‡∏õ‡∏∏‡πà‡∏°‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏•‡∏á‡πÉ‡∏ô‡∏ï‡∏∞‡∏Å‡∏£‡πâ‡∏≤ -->
                <form method="POST" action="{% url 'add_to_cart' product.id %}">
                    {% csrf_token %}
                    <button type="submit" class="btn btn-success">‚ûï ‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÉ‡∏ô‡∏ï‡∏∞‡∏Å‡∏£‡πâ‡∏≤</button>
                </form>

                <!-- üîô ‡∏Å‡∏•‡∏±‡∏ö‡πÑ‡∏õ‡∏´‡∏ô‡πâ‡∏≤‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤ -->
                <a href="{% url 'product_list' %}" class="btn btn-secondary">üîô ‡∏Å‡∏•‡∏±‡∏ö‡πÑ‡∏õ‡∏ó‡∏µ‡πà‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</a>
            </div>
        </div>
    </div>

    <!-- üåü ‡∏™‡πà‡∏ß‡∏ô‡πÅ‡∏™‡∏î‡∏á‡∏£‡∏µ‡∏ß‡∏¥‡∏ß -->
    <div class="reviews-section">
        <h3>üåü ‡∏£‡∏µ‡∏ß‡∏¥‡∏ß‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤</h3>

        {% for review in product.reviews.all %}
            <div class="review-box">
                <p><strong>{{ review.user.username }}</strong>: ‚≠ê {{ review.rating }}/5</p>
                <p>{{ review.comment }}</p>

                <!-- ‡πÅ‡∏™‡∏î‡∏á‡∏£‡∏π‡∏õ‡∏†‡∏≤‡∏û & ‡∏ß‡∏¥‡∏î‡∏µ‡πÇ‡∏≠ -->
                <div class="review-media">
                    {% for media in review.media.all %}
                        {% if media.media_type == "image" %}
                            <img src="{{ media.file.url }}" alt="Review Image" class="review-image">
                        {% elif media.media_type == "video" %}
                            <video controls class="review-video">
                                <source src="{{ media.file.url }}" type="video/mp4">
                                Your browser does not support the video tag.
                            </video>
                        {% endif %}
                    {% endfor %}
                </div>
            </div>
        {% empty %}
            <p>‚ö†Ô∏è ‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏£‡∏µ‡∏ß‡∏¥‡∏ß</p>
        {% endfor %}
    </div>

    <!-- üåü ‡∏ü‡∏≠‡∏£‡πå‡∏°‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏£‡∏µ‡∏ß‡∏¥‡∏ß -->
    {% if user.is_authenticated %}
        <div class="review-form">
            <h3>üìù ‡∏£‡∏µ‡∏ß‡∏¥‡∏ß‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤</h3>
            <form method="POST" action="{% url 'add_review' product.id %}" enctype="multipart/form-data">
                {% csrf_token %}
                <label>‡πÉ‡∏´‡πâ‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤:</label>
                <select name="rating">
                    <option value="5">‚≠ê 5</option>
                    <option value="4">‚≠ê 4</option>
                    <option value="3">‚≠ê 3</option>
                    <option value="2">‚≠ê 2</option>
                    <option value="1">‚≠ê 1</option>
                </select>

                <label>‡πÅ‡∏™‡∏î‡∏á‡∏Ñ‡∏ß‡∏≤‡∏°‡∏Ñ‡∏¥‡∏î‡πÄ‡∏´‡πá‡∏ô:</label>
                <textarea name="comment" required></textarea>

                <label>‡∏≠‡∏±‡∏õ‡πÇ‡∏´‡∏•‡∏î‡∏£‡∏π‡∏õ‡∏†‡∏≤‡∏û/‡∏ß‡∏¥‡∏î‡∏µ‡πÇ‡∏≠:</label>
                <input type="file" name="media" accept="image/*,video/*" multiple>

                <button type="submit" class="btn btn-primary">‚úÖ ‡∏™‡πà‡∏á‡∏£‡∏µ‡∏ß‡∏¥‡∏ß</button>
            </form>
        </div>
    {% else %}
        <p>üîí ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤ <a href="{% url 'login' %}">‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö</a> ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏£‡∏µ‡∏ß‡∏¥‡∏ß‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤</p>
    {% endif %}

    <!-- JS ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö Slider -->
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/slick-carousel/1.8.1/slick.min.js"></script>
    <script>
        $(document).ready(function(){
            $('.product-slider').slick({
                dots: true,
                infinite: true,
                speed: 300,
                slidesToShow: 1,
                adaptiveHeight: true
            });
        });
    </script>

</body>  
</html>