{% load static %}
<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>‡∏Ñ‡∏≥‡∏Ç‡∏≠‡∏Ñ‡∏∑‡∏ô‡πÄ‡∏á‡∏¥‡∏ô - ‡∏ú‡∏π‡πâ‡∏Ç‡∏≤‡∏¢</title>
    <link rel="stylesheet" href="{% static 'styles/refund_requests_seller.css' %}">
    <link rel="stylesheet" href="{% static 'styles/sidebar.css' %}">
</head>
<body>
    <div class="dashboard-container">
        <!-- Sidebar -->
        <aside class="sidebar">
            <h2 class="sidebar-title">‡∏Ñ‡∏≥‡∏Ç‡∏≠‡∏Ñ‡∏∑‡∏ô‡πÄ‡∏á‡∏¥‡∏ô</h2> 
            <ul class="menu">
                <li class="menu-header">üì¶ ‡∏Ñ‡∏≥‡∏™‡∏±‡πà‡∏á‡∏ã‡∏∑‡πâ‡∏≠</li>
                <li class="menu-item"><a href="{% url 'seller_dashboard' %}">‡πÅ‡∏î‡∏ä‡∏ö‡∏≠‡∏£‡πå‡∏î</a></li>
                <li class="menu-item"><a href="{% url 'seller_orders' %}">‡∏Ñ‡∏≥‡∏™‡∏±‡πà‡∏á‡∏ã‡∏∑‡πâ‡∏≠‡∏Ç‡∏≠‡∏á‡∏â‡∏±‡∏ô</a></li>
                <li class="menu-item"><a href="{% url 'seller_payment_verification' %}">‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏Å‡∏≤‡∏£‡∏ä‡∏≥‡∏£‡∏∞‡πÄ‡∏á‡∏¥‡∏ô</a></li>
                <li class="menu-item active"><a href="{% url 'seller_refund_requests' %}">‡∏Ç‡∏≠‡∏Ñ‡∏∑‡∏ô‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤</a></li>

                <li class="menu-header">üõç ‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤</li>
                <li class="menu-item"><a href="{% url 'my_products' %}">‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡∏Ç‡∏≠‡∏á‡∏â‡∏±‡∏ô</a></li>
                <li class="menu-item"><a href="{% url 'add_product' %}">‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡πÉ‡∏´‡∏°‡πà</a></li>

                <li class="menu-header"> ‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô‡∏õ‡∏£‡∏∞‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡∏†‡∏≤‡∏û‡∏£‡πâ‡∏≤‡∏ô‡∏Ñ‡πâ‡∏≤</li>
                <li class="menu-item"><a href="{% url 'seller_performance' %}">‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô‡∏õ‡∏£‡∏∞‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡∏†‡∏≤‡∏û‡∏£‡πâ‡∏≤‡∏ô‡∏Ñ‡πâ‡∏≤</a></li>

                <li class="menu-header">‚öôÔ∏è ‡∏Å‡∏≤‡∏£‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤</li>
                <li class="menu-item"><a href="{% url 'edit_store' %}">‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏£‡πâ‡∏≤‡∏ô‡∏Ñ‡πâ‡∏≤</a></li>
                <li class="menu-item"><a href="{% url 'edit_seller_profile' %}">‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡πÇ‡∏õ‡∏£‡πÑ‡∏ü‡∏•‡πå</a></li>
                <li class="menu-item"><a href="{% url 'seller_wallet' %}">‡∏Å‡∏£‡∏∞‡πÄ‡∏õ‡πã‡∏≤‡πÄ‡∏á‡∏¥‡∏ô</a></li>
                <li class="menu-item logout"><a href="{% url 'seller_logout' %}">‡∏≠‡∏≠‡∏Å‡∏à‡∏≤‡∏Å‡∏£‡∏∞‡∏ö‡∏ö</a></li>
            </ul>
        </aside>

        <!-- Main Content -->
        <main class="content">
            <h2>‡∏Ñ‡∏≥‡∏Ç‡∏≠‡∏Ñ‡∏∑‡∏ô‡πÄ‡∏á‡∏¥‡∏ô (‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏ú‡∏π‡πâ‡∏Ç‡∏≤‡∏¢)</h2>
            <p class="text-center text-muted">‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏Ñ‡∏≥‡∏Ç‡∏≠‡∏Ñ‡∏∑‡∏ô‡πÄ‡∏á‡∏¥‡∏ô‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î: <strong>{{ refund_requests.count }}</strong></p>

            {% if refund_requests %}
            <div class="refund-table">
                <table>
                    <thead>
                        <tr>
                            <th>#</th>
                            <th>‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤</th>
                            <th>‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤</th>
                            <th>‡πÄ‡∏´‡∏ï‡∏∏‡∏ú‡∏•</th>
                            <th>‡∏¢‡∏≠‡∏î‡∏£‡∏ß‡∏°</th>
                            <th>‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞</th>
                            <th>‡∏´‡∏•‡∏±‡∏Å‡∏ê‡∏≤‡∏ô‡∏Å‡∏≤‡∏£‡∏ä‡∏≥‡∏£‡∏∞‡πÄ‡∏á‡∏¥‡∏ô</th>
                            <th>‡∏´‡∏•‡∏±‡∏Å‡∏ê‡∏≤‡∏ô‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡∏ó‡∏µ‡πà‡∏™‡πà‡∏á‡∏Ñ‡∏∑‡∏ô</th> <!-- üîπ ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏Ñ‡∏≠‡∏•‡∏±‡∏°‡∏ô‡πå‡∏ô‡∏µ‡πâ -->
                            <th>‡∏≠‡∏±‡∏õ‡πÇ‡∏´‡∏•‡∏î‡∏™‡∏•‡∏¥‡∏õ‡∏Ñ‡∏∑‡∏ô‡πÄ‡∏á‡∏¥‡∏ô</th>
                            <th>‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô</th>
                            <th>‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£</th>
                        </tr>
                    </thead>
                    <tbody>
                        {% for refund in refund_requests %}
                        <tr>
                            <td>#{{ refund.order.id }}</td>
                            <td>{{ refund.user.username }}</td>
                            <td>
                                {% if refund.item %}
                                    {{ refund.item.product.name }} x {{ refund.item.quantity }} (‡∏ø{{ refund.item.price_per_item }})
                                {% else %}
                                    <ul>
                                        {% for item in refund.order.order_items.all %}
                                            <li>{{ item.product.name }} x {{ item.quantity }} (‡∏ø{{ item.price_per_item }})</li>
                                        {% empty %}
                                            ‚ùå ‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡πÉ‡∏ô‡∏Ñ‡∏≥‡∏™‡∏±‡πà‡∏á‡∏ã‡∏∑‡πâ‡∏≠
                                        {% endfor %}
                                    </ul>
                                {% endif %}
                            </td>                                                                                                       
                            <td>{{ refund.refund_reason }}</td>
                            <td>‡∏ø{{ refund.order.total_price }}</td>
                            <td>
                                {% if refund.status == "pending" %}
                                    ‚è≥ ‡∏£‡∏≠‡∏Å‡∏≤‡∏£‡∏Ñ‡∏∑‡∏ô‡πÄ‡∏á‡∏¥‡∏ô
                                {% elif refund.status == "approved" %}
                                    ‚úÖ ‡∏≠‡∏ô‡∏∏‡∏°‡∏±‡∏ï‡∏¥‡πÅ‡∏•‡πâ‡∏ß
                                {% elif refund.status == "confirmed" %}
                                    ‚úî ‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡πÅ‡∏•‡πâ‡∏ß
                                {% elif refund.status == "rejected" %}
                                    ‚ùå ‡∏ñ‡∏π‡∏Å‡∏õ‡∏è‡∏¥‡πÄ‡∏™‡∏ò
                                {% endif %}
                            </td>
                            <td>
                                {% if refund.payment_proof %}
                                    <a href="{{ refund.payment_proof.url }}" target="_blank" class="slip-btn">‡∏î‡∏π‡∏´‡∏•‡∏±‡∏Å‡∏ê‡∏≤‡∏ô</a>
                                {% else %}
                                    ‚ùå ‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏´‡∏•‡∏±‡∏Å‡∏ê‡∏≤‡∏ô
                                {% endif %}
                            </td>
                            <td>
                                {% if refund.return_item_proof %}
                                    <a href="{{ refund.return_item_proof.url }}" target="_blank" class="slip-btn">‡∏î‡∏π‡∏´‡∏•‡∏±‡∏Å‡∏ê‡∏≤‡∏ô‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤</a>
                                {% else %}
                                    ‚ùå ‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏´‡∏•‡∏±‡∏Å‡∏ê‡∏≤‡∏ô
                                {% endif %}
                            </td>                    
                            <td>
                                {% if refund.status == "approved" and not refund.refund_proof %}
                                    <a href="{% url 'upload_refund_proof' refund.id %}" class="btn upload">‡∏≠‡∏±‡∏õ‡πÇ‡∏´‡∏•‡∏î</a>
                                {% elif refund.refund_proof %}
                                    <a href="{{ refund.refund_proof.url }}" target="_blank" class="btn success">‡∏î‡∏π‡∏™‡∏•‡∏¥‡∏õ</a>
                                {% else %}
                                    ‚ùå ‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ‡∏≠‡∏ô‡∏∏‡∏°‡∏±‡∏ï‡∏¥
                                {% endif %}
                            </td>                    
                            <td>
                                {% if refund.status == "approved" and refund.refund_proof %}
                                    <a href="{% url 'confirm_refund_received' refund.id %}" class="btn confirm">‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô</a>
                                {% elif refund.status == "confirmed" %}
                                    ‚úî ‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡πÅ‡∏•‡πâ‡∏ß
                                {% else %}
                                    ‚ùå ‡∏£‡∏≠‡∏≠‡∏ô‡∏∏‡∏°‡∏±‡∏ï‡∏¥
                                {% endif %}
                            </td>
                            <td>
                                <div class="btn-group">
                                    {% if refund.status == "pending" %}
                                        <a href="{% url 'approve_refund' refund.id %}" class="btn btn-success">‡∏≠‡∏ô‡∏∏‡∏°‡∏±‡∏ï‡∏¥</a>
                                        <a href="{% url 'reject_refund' refund.id %}" class="btn btn-danger">‡∏õ‡∏è‡∏¥‡πÄ‡∏™‡∏ò</a>
                                    {% else %}
                                        ‚úÖ ‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£‡πÅ‡∏•‡πâ‡∏ß
                                    {% endif %}
                                </div>
                            </td>
                        </tr>
                        {% endfor %}
                    </tbody>
                </table>
            </div>
            {% else %}
                <p class="text-center text-muted">‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Ñ‡∏≥‡∏Ç‡∏≠‡∏Ñ‡∏∑‡∏ô‡πÄ‡∏á‡∏¥‡∏ô</p>
            {% endif %}
        </main>
    </div>
</body>
</html>
